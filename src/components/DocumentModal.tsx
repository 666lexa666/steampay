import React, { useEffect, useRef } from 'react';
import { X } from 'lucide-react';

interface DocumentModalProps {
  isOpen: boolean;
  onClose: () => void;
  documentType: string;
}

const documentContent: Record<string, { title: string; content: string }> = {
  offer: {
  title: 'Публичная оферта',
  content: `<p><strong>ПУБЛИЧНАЯ ОФЕРТА</strong><br/>
Редакция от «16» Ноября 2025 г.</p>

<p>1. Общие положения</p>
<p>1.1. Настоящая публичная оферта (далее — «Оферта») является официальным предложением ОсОО «ВЕРОНИКА», любому дееспособному физическому лицу (далее — «Пользователь») заключить договор поручения по приёму платежей в пользу иностранной компании — «Иностранного Поставщика».</p>
<p>1.2. «Иностранный Поставщик» — любая иностранная компания, с которой Агент заключил действующее агентское, субагентское или иное посредническое соглашение, в рамках которого Иностранный Поставщик оказывает Пользователю услугу пополнения баланса Steam или иные цифровые сервисные услуги.</p>
<p>1.3. Совершая оплату по реквизитам, указанным на сайте steampay.tech, Пользователь признаётся заключившим договор с Иностранным Поставщиком, а Агент — принявшим поручение на приём платежа.</p>

<p>2. Предмет договора</p>
<p>2.1. Агент принимает от Пользователя денежные средства, предназначенные для оплаты услуги Иностранного Поставщика по пополнению баланса Steam.</p>
<p>2.2. Агент не оказывает Пользователю услугу пополнения Steam, не формирует её стоимость и не несёт ответственности за результат исполнения. Исполнителем услуги является Иностранный Поставщик.</p>
<p>2.3. Агент передаёт поручение и данные об оплате Иностранному Поставщику или его уполномоченным партнёрам.</p>

<p>3. Способы оплаты</p>
<p>3.1. Оплата производится способами, указанными на сайте Агента, включая, но не ограничиваясь: переводом по Системе Быстрых Платежей (СБП), оплатой по QR-коду, банковским переводом, иными доступными платёжными методами.</p>
<p>3.2. Список доступных способов оплаты является динамическим и определяется техническими возможностями платёжных систем. Актуальная информация публикуется на сайте.</p>

<p>4. Лимиты и ограничения</p>
<p>4.1. Ограничения по суммам, количеству операций, суточным и месячным лимитам устанавливаются платёжными системами, банками, Иностранным Поставщиком либо Агентом.</p>
<p>4.2. Актуальные лимиты публикуются на сайте steampay.tech или на странице оплаты.</p>
<p>4.3. Попытки превышения лимитов могут приводить к автоматическому отклонению операций.</p>

<p>5. Порядок оплаты</p>
<p>5.1. Пользователь перечисляет денежные средства Агенту в пользу Иностранного Поставщика.</p>
<p>5.2. Денежные средства, поступающие Агенту, являются средствами Иностранного Поставщика и не являются доходом Агента.</p>
<p>5.3. Агентское вознаграждение определяется отдельными соглашениями между Агентом и Иностранным Поставщиком и Пользователю не раскрывается.</p>
<p>5.4. Оплата считается произведённой с момента поступления средств на счёт Агента.</p>

<p>6. Порядок исполнения услуги</p>
<p>6.1. После подтверждения оплаты Агент передаёт данные Иностранному Поставщику или его партнёрам.</p>
<p>6.2. Услуга считается оказанной Иностранным Поставщиком после зачисления средств на аккаунт Пользователя в Steam.</p>
<p>6.3. Агент не контролирует скорость исполнения услуги и не отвечает за сбои в работе Steam, Valve, платёжных систем или иных третьих лиц.</p>

<p>7. Возвраты</p>
<p>7.1. Возврат возможен только в случае невозможности оказания услуги Иностранным Поставщиком.</p>
<p>7.2. Агент производит возврат после получения подтверждения от Иностранного Поставщика.</p>

<p>8. Разрешение споров</p>
<p>8.1. Вопросы по оплате направляются Агенту на электронную почту: <strong>kudurettilla@icloud.com</strong>.</p>
<p>8.2. Вопросы по качеству и срокам исполнения услуги Пользователь направляет непосредственно Иностранному Поставщику.</p>

<p>9. Заключительные положения</p>
<p>9.1. Оферта опубликована на сайте steampay.tech.</p>
<p>9.2. Агент вправе изменять условия Оферты без уведомления Пользователя.</p>
<p>9.3. Продолжение использования сайта и/или совершение платежа означает акцепт новой редакции Оферты.</p>
<p>9.4. Реквизиты Агента:<br/>
Общество с ограниченной ответственностью "ВЕРОНИКА" (ОсОО "ВЕРОНИКА")<br/>
Limited Liability Company Veronika (LLC Veronika)<br/>
РФ ИНН: 9909747653, КПП: 773687001<br/>
Юридический адрес: Кыргызская Республика, Бишкек, Свердловский район, ул. Чалдыбар (ж/м Ак-Тилек), 2а<br/>
Ванян Тигран Паргевович<br/>
E-mail: <strong>kudurettilla@icloud.com</strong></p>`
},
  privacy: {
  title: 'Политика конфиденциальности',
  content: `<p><strong>ПОЛИТИКА ОБРАБОТКИ ПЕРСОНАЛЬНЫХ ДАННЫХ</strong><br/>
Редакция от «16» Ноября 2025 г.</p>

<p>1. Общие положения</p>
<p>1.1. Настоящая Политика обработки персональных данных (далее — «Политика») определяет порядок обработки и защиты персональных данных, которые обрабатываются ОсОО «ВЕРОНИКА» (ОсОО "ВЕРОНИКА"), Limited Liability Company Veronika (LLC Veronika), далее — Общество.</p>
<p>1.2. Общество осуществляет деятельность по приёму денежных средств Пользователей в пользу иностранной компании («Иностранного Поставщика»), оказывающей услуги по пополнению баланса Steam и иные цифровые сервисные услуги. Общество не оказывает услугу Пользователю, а только передаёт оплату и информацию Иностранному Поставщику.</p>
<p>1.3. Политика разработана в соответствии с Федеральным законом РФ №152-ФЗ «О персональных данных».</p>

<p>2. Состав и источники персональных данных</p>
<p>2.1. Сайт steampay.tech не собирает и не обрабатывает персональные данные Пользователей напрямую.</p>
<p>2.2. Общество получает персональные данные только от банков и платёжных организаций в составе платёжных транзакций.</p>
<p>2.3. К обрабатываемым данным относятся: ФИО плательщика; номер телефона, указанный при платеже; реквизиты и параметры платёжной операции; сумма и дата платежа.</p>
<p>2.4. Пользователь самостоятельно предоставляет только Логин Steam, который не относится к персональным данным, поскольку не позволяет идентифицировать физическое лицо.</p>

<p>3. Цели обработки персональных данных</p>
<ul>
<li>3.1. Идентификация поступившего платежа;</li>
<li>3.2. Передача информации об оплате Иностранному Поставщику или его уполномоченным партнёрам;</li>
<li>3.3. Исполнение обязательств Общества в рамках договора поручения — приёма денежных средств в пользу Иностранного Поставщика;</li>
<li>3.4. Выполнение требований законодательства РФ в части бухгалтерского и финансового учёта.</li>
</ul>

<p>4. Правовые основания обработки</p>
<ul>
<li>4.1. Федеральный закон №152-ФЗ «О персональных данных»;</li>
<li>4.2. Публичная оферта, размещённая на сайте steampay.tech;</li>
<li>4.3. Действующие договоры между Обществом и Иностранным Поставщиком.</li>
</ul>

<p>5. Порядок и условия обработки персональных данных</p>
<ul>
<li>5.1. Общество не осуществляет хранение персональных данных в собственных информационных системах. Данные хранятся в платёжных системах банков;</li>
<li>5.2. Общество использует данные только в объёме, необходимом для идентификации платежа и передачи сведений Иностранному Поставщику;</li>
<li>5.3. Общество не передает персональные данные третьим лицам, за исключением: Иностранного Поставщика (для исполнения поручения), банков и платёжных систем, случаев, предусмотренных законодательством РФ;</li>
<li>5.4. Общество не использует данные в целях маркетинга, рекламы, статистики, профилирования и иных целях, не связанных с исполнением обязательств.</li>
</ul>

<p>6. Права субъектов персональных данных</p>
<ul>
<li>6.1. Пользователь вправе запрашивать информацию о факте обработки его персональных данных;</li>
<li>6.2. Требовать уточнения, блокирования или удаления персональных данных в случаях, установленных законом;</li>
<li>6.3. Отозвать своё согласие на обработку персональных данных, направив запрос на электронную почту: <strong>kudurettilla@icloud.com</strong>.</li>
</ul>

<p>7. Защита персональных данных</p>
<ul>
<li>7.1. Общество обеспечивает конфиденциальность персональных данных, доступных ему в рамках обработки платёжных транзакций;</li>
<li>7.2. Общество принимает меры по недопущению несанкционированного доступа к персональным данным, находящимся в системах банков.</li>
</ul>

<p>8. Заключительные положения</p>
<ul>
<li>8.1. Политика размещена на сайте steampay.tech и доступна для ознакомления;</li>
<li>8.2. Общество вправе вносить изменения в настоящую Политику без предварительного уведомления Пользователей;</li>
<li>8.3. Новая редакция Политики вступает в силу с момента её публикации на сайте.</li>
</ul>

<p>Реквизиты:<br/>
Общество с ограниченной ответственностью "ВЕРОНИКА" (ОсОО "ВЕРОНИКА")<br/>
Limited Liability Company Veronika (LLC Veronika)<br/>
РФ ИНН: 9909747653, КПП: 773687001<br/>
Юридический адрес: Кыргызская Республика, Бишкек, Свердловский район, ул. Чалдыбар (ж/м Ак-Тилек), 2а<br/>
Ванян Тигран Паргевович<br/>
E-mail: <strong>kudurettilla@icloud.com</strong></p>`
},
  consent: {
  title: 'Согласие на обработку персональных данных',
  content: `<p>ПОЛЬЗОВАТЕЛЬСКОЕ СОГЛАШЕНИЕ</p>

<p>Редакция от «16» ноября 2025 г.</p>

<p>1. Общие положения</p>
<p>1.1. Настоящее Пользовательское соглашение (далее — «Соглашение») определяет условия использования сайта steampay.tech и регулирует отношения между Обществом с ограниченной ответственностью "ВЕРОНИКА" (ОсОО "ВЕРОНИКА", Limited Liability Company Veronika, LLC Veronika, далее — «Агент») и пользователем сайта (далее — «Пользователь»).</p>
<p>1.2. Посещая сайт, используя его функционал либо совершая оплату, Пользователь принимает условия настоящего Соглашения, а также Публичной оферты и Политики обработки персональных данных.</p>
<p>1.3. Агент осуществляет деятельность по приёму денежных средств Пользователя в пользу Иностранного Поставщика и не оказывает услуги по пополнению баланса Steam или иные цифровые услуги Пользователю.</p>

<p>2. Статус Агента и Иностранного Поставщика</p>
<p>2.1. Агент действует в рамках договора поручения, заключённого с Иностранным Поставщиком, оказывающим Пользователю услугу по пополнению баланса Steam.</p>
<p>2.2. Агент:</p>
<ul>
<li>принимает оплату от Пользователя,</li>
<li>передаёт поручение и информацию о платеже Иностранному Поставщику,</li>
<li>не оказывает услуги по пополнению баланса,</li>
<li>не устанавливает стоимость услуги,</li>
<li>не несёт ответственности за исполнение услуги.</li>
</ul>
<p>2.3. Все вопросы, связанные с качеством, сроками и корректностью пополнения баланса Steam, относятся к сфере ответственности Иностранного Поставщика.</p>

<p>3. Использование сайта</p>
<p>3.1. Пользователь обязуется использовать сайт исключительно в законных целях.</p>
<p>3.2. Для осуществления платежа Пользователь должен указать Логин Steam (не относится к персональным данным).</p>
<p>3.3. Пользователь несёт ответственность за корректность вводимых данных и выбираемой суммы.</p>

<p>4. Способы оплаты</p>
<p>4.1. Оплата осуществляется любыми способами, указанными на сайте Агента, включая:</p>
<ul>
<li>перевод через СБП,</li>
<li>оплату по QR-коду,</li>
<li>банковский перевод.</li>
</ul>
<p>4.2. Агент вправе изменять доступные способы оплаты в одностороннем порядке. Актуальный перечень всегда отображается на сайте.</p>

<p>5. Лимиты и ограничения</p>
<p>5.1. На операции могут распространяться лимиты, установленные:</p>
<ul>
<li>платёжными системами,</li>
<li>Иностранным Поставщиком,</li>
<li>Агентом.</li>
</ul>
<p>5.2. Лимиты могут включать:</p>
<ul>
<li>максимальную сумму одного платежа,</li>
<li>максимальную сумму в сутки,</li>
<li>максимальную сумму в месяц,</li>
<li>ограничения по скорости операций.</li>
</ul>
<p>5.3. Актуальные лимиты указываются на странице оплаты и в интерфейсе формирования платежа.</p>
<p>5.4. Лимиты могут изменяться без уведомления Пользователя.</p>

<p>6. Порядок исполнения услуги</p>
<p>6.1. Агент после получения платежа передает информацию Иностранному Поставщику.</p>
<p>6.2. Исполнителем услуги по пополнению баланса Steam является Иностранный Поставщик.</p>
<p>6.3. Услуга считается оказанной Иностранным Поставщиком после зачисления средств на аккаунт Steam.</p>
<p>6.4. Агент не несет ответственности за:</p>
<ul>
<li>задержки исполнения услуги,</li>
<li>технические сбои Steam/Valve,</li>
<li>сбои банков и платёжных систем,</li>
<li>превышение лимитов,</li>
<li>действия третьих лиц.</li>
</ul>

<p>7. Возвраты</p>
<p>7.1. Возврат возможен только в случае невозможности оказания услуги Иностранным Поставщиком.</p>
<p>7.2. Агент осуществляет возврат после подтверждения от Иностранного Поставщика.</p>

<p>8. Персональные данные</p>
<p>8.1. Порядок обработки персональных данных регулируется Политикой обработки персональных данных.</p>

<p>9. Ограничение ответственности</p>
<p>9.1. Агент не гарантирует бесперебойную работу сайта.</p>
<p>9.2. Агент не несет ответственности за ущерб, возникший в результате:</p>
<ul>
<li>некорректных действий Пользователя,</li>
<li>действий платёжных систем,</li>
<li>технических сбоев Steam/Valve,</li>
<li>действий третьих лиц.</li>
</ul>

<p>10. Заключительные положения</p>
<p>10.1. Агент вправе изменять условия настоящего Соглашения без уведомления Пользователей.</p>
<p>10.2. Новая редакция вступает в силу с момента публикации на сайте.</p>
<p>10.3. Продолжение использования сайта означает согласие с новой редакцией.</p>

<p>Реквизиты:<br/>
Общество с ограниченной ответственностью "ВЕРОНИКА" (ОсОО "ВЕРОНИКА")<br/>
Limited Liability Company Veronika (LLC Veronika)<br/>
РФ ИНН: 9909747653, КПП: 773687001<br/>
Юридический адрес: Кыргызская Республика, Бишкек, Свердловский район, ул. Чалдыбар (ж/м Ак-Тилек), 2а<br/>
Ванян Тигран Паргевович<br/>
E-mail: kudurettilla@icloud.com</p>`
},
  refusal: {
  title: 'Отказ от услуги',
  content: `<p><strong>ПОЛИТИКА ВОЗВРАТОВ И ОТМЕН (REFUND POLICY)</strong><br/>
ОсОО «ВЕРОНИКА»<br/>
Редакция от «16» Ноября 2025 г.</p>

<p><strong>1. Общие положения</strong></p>
<p>1.1. Настоящая Политика возвратов и отмен (далее — «Политика») определяет порядок возврата денежных средств Пользователю при оплате услуг Иностранного Поставщика через Агента на сайте steampay.tech.</p>
<p>1.2. Агент (ОсОО «ВЕРОНИКА») принимает платежи в пользу Иностранного Поставщика и не оказывает Пользователю услугу пополнения баланса Steam.</p>
<p>1.3. Исполнителем услуги является Иностранный Поставщик, который осуществляет пополнение аккаунта Steam или иные цифровые операции.</p>

<p><strong>2. Возможность возврата</strong></p>
<p>2.1. Возврат денежных средств возможен только в случае, если услуга не была оказана Иностранным Поставщиком.</p>
<p>2.2. Услуга считается оказанной с момента зачисления средств на аккаунт Пользователя в Steam.</p>
<p>2.3. Возврат невозможен, если:</p>
<ul>
  <li>средства уже зачислены на аккаунт Steam Пользователя;</li>
  <li>Пользователь указал неправильный логин;</li>
  <li>Пользователь инициировал двойной платёж и требует отмену уже исполненной операции;</li>
  <li>Иностранный Поставщик сообщил об успешном исполнении услуги.</li>
</ul>

<p><strong>3. Порядок возврата</strong></p>
<p>3.1. Для возврата Пользователь направляет запрос на e-mail: <strong>kudurettilla@icloud.com</strong>, указав:</p>
<ul>
  <li>ФИО плательщика,</li>
  <li>дату и сумму платежа,</li>
  <li>номер операции (если имеется),</li>
  <li>логин Steam,</li>
  <li>причину запроса.</li>
</ul>
<p>3.2. Агент проверяет факт исполнения услуги у Иностранного Поставщика.</p>
<p>3.3. Возврат осуществляется только после официального подтверждения Иностранного Поставщика, что операция не выполнена и средства могут быть возвращены.</p>
<p>3.4. Агент не обязан осуществлять возврат до момента получения подтверждения от Иностранного Поставщика.</p>

<p><strong>4. Сроки возврата</strong></p>
<p>4.1. Проверка статуса услуги занимает до 5 рабочих дней.</p>
<p>4.2. После подтверждения возврата денежные средства перечисляются Пользователю в течение 5–10 рабочих дней, в зависимости от банка.</p>
<p>4.3. Общий срок обработки возврата может составлять до 15 рабочих дней.</p>

<p><strong>5. Способ возврата</strong></p>
<p>5.1. Возврат осуществляется только тем же способом, которым был осуществлён платёж, на тот же банковский счёт/карту.</p>
<p>5.2. Агент не осуществляет возвраты на другие счета или карты по просьбе Пользователя.</p>

<p><strong>6. Отмена платежа</strong></p>
<p>6.1. Отмена платежа возможна только до момента передачи данных Иностранному Поставщику.</p>
<p>6.2. Платёж может быть отменён Агентом автоматически, если:</p>
<ul>
  <li>превышены лимиты банка или платёжной системы;</li>
  <li>платёж не соответствует параметрам операции;</li>
  <li>банк отклонил транзакцию;</li>
  <li>есть признаки подозрительной операции по 115-ФЗ.</li>
</ul>
<p>6.3. Если транзакция отменена до передачи Иностранному Поставщику, средства возвращаются Пользователю в полном объёме.</p>

<p><strong>7. Особые условия</strong></p>
<p>7.1. Агент не несёт ответственности за:</p>
<ul>
  <li>задержки исполнения услуги Иностранным Поставщиком,</li>
  <li>сбои в Steam или Valve,</li>
  <li>сбои в работе банков или платёжных систем,</li>
  <li>неправильные данные, указанные Пользователем.</li>
</ul>
<p>7.2. Повторные возвраты по одной и той же операции не осуществляются.</p>

<p><strong>8. Контактная информация</strong></p>
<p>
Общество с ограниченной ответственностью "ВЕРОНИКА" (ОсОО "ВЕРОНИКА")<br/>
Limited Liability Company Veronika (LLC Veronika)<br/>
РФ ИНН: 9909747653, КПП: 773687001<br/>
Юридический адрес: Кыргызская Республика, Бишкек, Свердловский район, ул. Чалдыбар (ж/м Ак-Тилек), 2а<br/>
Ванян Тигран Паргевович<br/>
E-mail: <strong>kudurettilla@icloud.com</strong>
</p>`
},
};

const DocumentModal: React.FC<DocumentModalProps> = ({ isOpen, onClose, documentType }) => {
  const modalRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (!isOpen) return;

    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === 'Escape') onClose();
    };

    window.addEventListener('keydown', handleKeyDown);

    // TS не ругается, если явно проверяем body
    const body = document.body;
    if (body) body.style.overflow = 'hidden';

    return () => {
      window.removeEventListener('keydown', handleKeyDown);
      if (body) body.style.overflow = 'auto';
    };
  }, [isOpen, onClose]);

  if (!isOpen || !documentContent[documentType]) return null;

  const documentItem = documentContent[documentType];

  return (
    <div className="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4">
      <div
        ref={modalRef}
        className="bg-gradient-to-br from-gray-800 to-gray-900 border border-cyan-500/30 rounded-2xl p-6 w-full max-w-2xl max-h-[80vh] overflow-hidden transform transition-all scale-100"
        role="dialog"
        aria-modal="true"
        aria-labelledby="document-modal-title"
      >
        {/* Header */}
        <div className="flex items-center justify-between mb-6">
          <h3 id="document-modal-title" className="text-2xl font-bold text-white">
            {documentItem.title}
          </h3>
          <button onClick={onClose} className="text-gray-400 hover:text-white transition-colors" aria-label="Закрыть">
            <X className="h-6 w-6" />
          </button>
        </div>

        {/* Content */}
        <div className="overflow-y-auto max-h-96 pr-2">
          <div
            className="text-gray-300 prose prose-sm max-w-none prose-headings:text-white prose-headings:font-bold prose-p:text-gray-300 prose-ul:text-gray-300 prose-li:text-gray-300"
            dangerouslySetInnerHTML={{ __html: documentItem.content }}
          />
        </div>

        {/* Close Button */}
        <div className="mt-6 pt-6 border-t border-gray-700">
          <button
            onClick={onClose}
            className="w-full px-4 py-3 bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-400 hover:to-purple-500 text-white rounded-lg transition-all transform hover:scale-105"
          >
            Закрыть
          </button>
        </div>
      </div>
    </div>
  );
};

export default DocumentModal;
